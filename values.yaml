replicaCount: 1

# структура поудобнее для понимания:
#  frontend:
#    image:
#      repository: my-frontend
#      tag: latest
#      pullPolicy: Never
#    service:
#      type: ClusterIP
#      port: 80
#      targetPort: 80
#    resources:
#      requests:
#        memory: "128Mi"
#        cpu: "100m"
#      limits:
#        memory: "256Mi"
#        cpu: "200m"
#  backend:
#    image: ...

image:
  frontend:
    repository: my-frontend # лучше использовать полное имя репозитория: piktakatya/my-backend
    tag: latest # latest, лучше использовать конкретный тег, например, v1.0.0
    pullPolicy: Never
  backend:
    repository: my-backend
    tag: latest
    pullPolicy: Never
  db:
    repository: mysql
    tag: 8.0
    pullPolicy: IfNotPresent
  redis:
    repository: redis
    tag: 7-alpine
    pullPolicy: IfNotPresent

service:
  frontend:
    type: ClusterIP
    port: 80
    targetPort: 80
  backend:
    type: ClusterIP
    port: 5000
    targetPort: 5000
  db:
    type: ClusterIP
    port: 3306
    targetPort: 3306
  redis:
    type: ClusterIP
    port: 6379
    targetPort: 6379

ingress:
  enabled: true # только этот параметр влияет на ингресс, остальное не используется в темплейте
  className: "nginx"
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: task2.local
      paths:
        - path: /api/tasks
          pathType: Prefix
          backend:
            serviceName: backend
            servicePort: 5000
        - path: /
          pathType: Prefix
          backend:
            serviceName: frontend
            servicePort: 80
        
  tls: []

configMap:
  enabled: true
  data:
    MYSQL_USER: "root" 
    MYSQL_HOST: "db"   # хостнеймы сервисов должны быть настроены самим чартом
    MYSQL_DB: "tasks_db"
    REDIS_HOST: "redis" 
    REDIS_PORT: "6379"  
    FE_HOST: "frontend:80"
    FLASK_ENV: "development"
    API_URL: ""

secret: # безопаснее хранить готовый секрет и ссылаться на него values.yaml файле
  enabled: true # если будет false, деплойменты сломаются, т.к. не найдут секрет
  data:
    MYSQL_PASSWORD: "cGFzcw=="
    MYSQL_ROOT_PASSWORD: "cGFzcw=="

persistence:
  db:
    enabled: true
    storageClass: "standard"
    accessMode: ReadWriteOnce
    size: 8Gi
  redis:
    enabled: true
    storageClass: "standard"
    accessMode: ReadWriteOnce
    size: 1Gi

resources:
  frontend:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  backend:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  db:
    requests:
      memory: "512Mi"
      cpu: "300m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  redis:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
